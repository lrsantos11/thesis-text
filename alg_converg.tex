%!TEX root = tese.tex


\section{Convergência  Polinomial do Algoritmo de Escolha Adiada de Parâmetros}



Vamos provar  a convergência do Algoritmo \ref{alg:optimized-choice-of-parameters}. Para tanto, estrategicamente fixaremos os parâmetros $(\mu,\sig)$. Neste sentido escolheremos para o parâmetro  $\mu$ o valor \[\nextmu=\eta\dfrac{x^Tz}{n},
\] 
em que $\eta\in [\eta_{\min},\eta_{\max} ]$, enquanto o parâmetro $\sig$ será fixado como $\nextsig = 0$. Essas escolhas  podem fazer com que nosso método resolva  sistemas lineares similares aos dos métodos seguidores de caminho, vistos no Capítulo~\ref{chap:mpis}.  No entanto, para fins de clareza, e sem perda de generalidade, vamos supor $\eta$ fixo. Os valores de $\eta_{\min}$ e $\eta_{\max}$ serão determinados no Lema~\ref{lemma:next-phi-delta-n4}.


 Na prática, porém, esperamos que  o método  tenha desempenho melhor do que a convergência teórica, já que se buscará, em cada iteração $k$,
o minimizador global de $\nextphi$ através da solução do problema \eqref{eq:pop-subproblem}, dado por $(\al^*,\mu^*,\sig^*)$ e portanto	$\nextphi(\al^*,\mu^*,\sig^*)\leq \nextphi(\hat{\al},\nextmu,\nextsig)$, para  $\hat{\al}$ definido abaixo.


Com essas alterações, podemos rescrever o Algoritmo~\ref{alg:optimized-choice-of-parameters} como o  Algoritmo Simplificado \ref{alg:optimized-choice-of-parameters-simplified}.


A fim de pode  resolver o o problema primal-dual (\ref{eq:primal}-\ref{eq:dual}), vamos considerar válido o Pressuposto \ref{ass:interior-nonempty}, isto é, que o interior da região factível é não vazio. Além disso, vamos considerar que o \ac{PL} em questão possui ao menos uma solução ótima. 





Pelo Teorema \ref{thm:varphi}, a função de mérito para o próximo ponto   é, nas variáveis  $(\al,\mu,\sig)$,
\begin{equation*}
% \label{eq:merit-function-al-mu-sig}
{\nextphi}(\al,\mu,\sig) =  (1-\al)(\dbvec{\rho_L} +
\dbvec{\rho_C^k }) + \al\mu + \al(\al-\sig)\dbvec{L_{0,0}} +
\al^2\dbvec{\Lambda(\mu,\sig)} ,
\end{equation*}
em que 
\[
\dbvec{\Lambda(\mu,\sig)} = \mu^2
 \dbvec{L_{2,0}} + \mu \dbvec{L_{1,0}} + 	\mu \sig \dbvec{L_{1,1}} +
 \sig^2 \dbvec{L_{0,2}} + \sig \dbvec{L_{0,1}}.
 \]


Como vimos na Observação \ref{obs:L_02-L20},  $\dbvec{L_{2,0}} = \dbvec{L_{0,2}} = 0$. Fazendo $\mu = \nextmu = \eta\frac{x^Tz}{n} = \eta\dbvec{\rho_C^k } $
 e $\sig = \nextsig=0$ e usando a Proposição \ref{prop:nu_k},   podemos rescrever a função de mérito para o próximo ponto, dependendo apenas de uma escolha de  $\al$ como
\begin{equation}
	\label{eq:simplified-merit-function-al}
\nextphi(\al)  = (1-\al)(\nu_k\dbvec{\rho_L}_0 +
\dbvec{\rho_C^k }) + \al\eta\dbvec{\rho_C^k } + \al^2\left(\dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}}
\right) .
\end{equation}

Seja a função auxiliar  dada por
\begin{equation}
	\label{eq:theta}
\theta(\al) =  \dfrac{\al\left[ \nu_k\dbvec{\rho_L}_0 + (1-\eta)\dbvec{\rho_C^k } - \al\left(\dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}}
\right) \right]}{\nu_k\dbvec{\rho_L}_0 +
\dbvec{\rho_C^k }}.
\end{equation}
Usando tal definição, deriva-se a seguinte relação entre a função de mérito atual  $\varphi$  e a da próxima iteração  $\nextphi$: 
\begin{equation}
	\label{eq:relation-phi-next-phi}
	 			{\nextphi} = (1- \theta(\al))\varphi.
\end{equation}


Como é necessário garantir que  $\nextphi  $  seja não negativa, deve-se escolher um tamanho de passo  $\al_k$, em cada iteração $k$, tal que  $\theta_k = \theta(\al_k)<1$. Além disso, se existir um escalar $\theta>0$, tal que $\theta = \liminf (\theta_k)$, isto é, se a sequência $\{\theta_k\}$ for limitada inferiormente por um valor positivo,	 então a sequência $\{\varphi_k\}$, gerada pelo Algoritmo \ref{alg:optimized-choice-of-parameters-simplified}, converge para zero Q-linearmente~\cite{Ortega:2000vd}.




 Em vista disso, para garantirmos a convergência dos pontos gerados pelo Algoritmo para uma solução ótima $(\xstar,\ystar,\zstar)$ do problema de \ac{PL}, além de ser  crucial que exista $\hat{\al}>0$  tal que,  para toda iteração $k$, tenha-se  $\al_k\in(0,\hat{\al}]$, de modo que a equação~\eqref{eq:relation-phi-next-phi} seja válida, é preciso que todo   ponto  $({x}^{k} ,{y}^{k},{z}^{k})$ pertença à vizinhança $\Nset_{-\infty}(\gamma,\beta)$.

Para tanto, sejam  
\begin{equation}
	\label{eq:al-C+al-L}
\begin{cases}
	\hat{\al}_{C}^{i} = \displaystyle \max_{\al\in (0,1]} \{ \al : g_{C}^{i}(\upsilon,\nextmu,\nextsig)\geq0 \text{ para todo } 0 \leq \upsilon\leq \al  \}, & i = 1,\ldots,n,\\
	\hat{\al}_{C} = \displaystyle \min_{1\leq i \leq n} \{\hat{\al}_{C}^{i}\}, \\
	\hat{\al}_{L} = \displaystyle \max_{\al\in (0,1]} \{ \al : g_{L}(\upsilon,\nextmu,\nextsig)\geq0 \text{ para todo } 0 \leq  \upsilon\leq \al  \},
\end{cases}
\end{equation}
em que $g_{C}^{i}$ e $g_{L}$ são dadas pelas equações  \eqref{eq:g-Ci_explicit} e \eqref{eq:g-L_explicit}, já tendo sido fixados os parâmetros $\mu=\nextmu$ e $\sig=\nextsig$.


Com isso, escolheremos  $\hat\al$ que garanta decréscimo suficiente de $\nextphi$ ao mesmo em que haja a pertinência de $({x}^{k} ,{y}^{k},{z}^{k})$ à vizinhança $\Nset_{-\infty}(\gamma,\beta)$ por sujeitar $\nextphi$ tanto à  \eqref{eq:g-Ci_explicit} quanto à \eqref{eq:g-L_explicit}. Isso será feito simplesmente por escolher

\begin{equation}
	\label{eq:nex-al}
\nextal = \min\{\nextal_{C},\nextal_{L}\},
\end{equation}
em que $\nextal_{C}$ e $\nextal_{L}$ são definidos nos Lemas \ref{lemma:alC_delta-1} e  \ref{lemma:alL_delta-2}.

% -- neste caso,  em que $\mu$ e $\sig$ estão fixados --  por escolher o tamanho de passo $\nextal$ como
% \begin{equation}
% 	\label{eq:nex-al}
% \nextal = \argmax \left\{ \theta(\al): \al\in\left[0,\min\{\nextal_{C},\nextal_{L}\}\right]\right\}.
% \end{equation}
  


% De fato, a função $\theta(\al)$ é uma quadrática, e por conta disso, o problema \eqref{eq:nex-al} é resolvido por comparar os valores funcionais de $\theta(\al)$ em seus pontos críticos no interior do intervalo e o valor funcional no ponto mais a direita do intervalo.


 Essa escolha garante que  o Algoritmo \ref{alg:optimized-choice-of-parameters-simplified} gere uma sequência $\{\varphi_k\}$ que decresce de maneira suficiente a cada passo, tal que $\varphi_k \to 0$, quando $k\to \infty$. Assim, o Algoritmo gera pontos $({x}^{k} ,{y}^{k},{z}^{k})$ que tem as boas propriedades da vizinhança $\Nset_{-\infty}(\gamma,\beta)$ e ainda faz com que $({x}^{k} ,{y}^{k},{z}^{k})$ convirja para  alguma solução ótima $(\xstar ,\ystar,\zstar)$ do problema primal-dual  (\ref{eq:primal}-\ref{eq:dual}).


Em seguida, fazemos a demonstração da convergência do Algoritmo proposto. A análise que segue é  baseada naquelas feitas por \textcite[cap. 6]{Wright:Primal-dual-interior-point:1997h},  \textcite{Zhang:2006ic,Zhang:1995fu}. 

% \section{Ponto Inicial}


\section{Resultados técnicos}



A fim de demonstrarmos a convergência e a complexidade do Algoritmo proposto, na presente seção provaremos alguns lemas técnicos que serão utilizados para estabelecer nossos principais resultados de convergência. 




Em demonstrações de convergência e polinomialidade de Métodos de Pontos Interiores  infactíveis, é  necessária a aceitação de algumas hipóteses ou condições sobre o ponto inicial e o sobre o ponto ótimo. Veja por exemplo os trabalhos de \textcite{Wright:1994jd}, \textcite[cap. 6]{Wright:Primal-dual-interior-point:1997h}, \textcite{Wright:1996kj,Zhang:2006ic,Zhang:1994fz,Zhang:1995fu}. Em particular, tais hipóteses permitem estabelecer um limitante para a sequência $\{(\xk,\zk)\}$, o que é de vital importância para as demonstrações.

No entanto, embora as hipóteses utilizadas nos trabalhos acima, permitam uma ordem de convergência  polinomial, ao mesmo tempo, são impraticáveis do ponto da implementação, já que utilizam pontos iniciais que geram péssimo comportamento do algoritmo e ao mesmo tempo, exigem um limitante para o ponto ótimo que não pode ser calculado e que na prática, para conjuntos de testes.

Nesse trabalho, preferimos de obter uma ordem de convergência maior, embora polinomial, porém com um ponto inicial cuja eficácia é bem demonstrada na prática e com  condições para limitantes  do ponto ótimo e do ponto inicial que possam ser verificada como verdadeiras, pelo menos para nosso conjunto de testes. Em resumo, isso significa que a análise de convergência é feita utilizando o Algoritmo que é de fato implementado.



Como vimos na Seção \ref{subsec:initial-point}, a heurística introduzida por \textcite{Mehrotra:1992wr} é uma das mais utilizadas em diversos Metódos de Pontos Interiores, por suas características e consequente bom desempenho na prática.
Considere então que estaremos utilizando o ponto inicial de \textcite{Mehrotra:1992wr}, isto é, que $(\xzero ,\yzero,\zzero )$ seja dado pela equação \eqref{eq:initial-point-mehrotra}. Seja também, para este ponto inicial, a constante positiva

\begin{equation}
\label{eq:bdxzzero}
	\bdxzzero= \min_{i=1,\ldots,n}\min\{\xzero_{i},\zzero_{i}\}.
\end{equation}




Formalizamos agora as condições sobre o ponto inicial e o ponto final que utilizaremos nas demonstrações abaixo. Para isso, definimos a constante positiva
\begin{equation}
	\label{eq:max-norm-data}
 	\bdxzstar = \max\{\abs{A_{ij}},\abs{b_{i}},\abs{c_{j}}, \text{ para } 1\leq i\leq m \text{ e } 1\leq j \leq n  \},
\end{equation}
que nada mais é que o maior valor absoluto de todos os dados de entrada do problema. 
Com isso podemos assumir como verdadeiras as  condições a seguir, que caracterizam o ponto inicial e um ponto ótimo do problema de PL que estamos resolvendo. 

\begin{cond} \label{cond:xzzero} O ponto inicial $(\xzero ,\yzero,\zzero )$ satisfaz 
\begin{equation}
	\label{eq:norm-xz-zero}
	\norm{(\xzero,\zzero)}_{1} \leq \bdxzstar n,
\end{equation}
em que  $\bdxzstar>0$ calculado por \eqref{eq:max-norm-data}.
\end{cond}

\begin{cond} \label{cond:xzstar} Existe uma solução ótima $(\xstar,\ystar,\zstar)$  do problema (\ref{eq:primal}-\ref{eq:dual}) que satisfaz 
\begin{equation}
	\label{eq:norm-xz-star}
	\norm{(\xstar,\zstar)}_{\infty} \leq \bdxzstar n^2,
\end{equation}
em que  $\bdxzstar>0$ calculado por \eqref{eq:max-norm-data}. 
\end{cond}



\begin{cond}\label{cond:x0-x*+z0-z*}  O ponto inicial $(\xzero ,\yzero,\zzero )$ e o ponto ótimo $(\xstar,\ystar,\zstar)$ que satisfazem respectivamente as Condições \ref{cond:xzzero} e \ref{cond:xzstar}, também satisfazem as desigualdades
\begin{subequations}\label{eq:x0-x*+z0-z*}
\begin{gather}
\norm{\xzero - \xstar} \leq n^2 \bdxzstar \label{eq:x0-x*} \\
\norm{\zzero - \zstar} \leq n^2\bdxzstar \label{eq:z0-z*}
\end{gather}
\end{subequations}
em que  $\bdxzstar>0$ calculado por \eqref{eq:max-norm-data}. 
\end{cond}


Reiteramos aqui que  as três Condições acima foram verificadas como válidas em nosso conjunto de testes. Isso significa, que na prática, essas condições são razoáveis. No Capítulo \ref{chap:numerical}, tal conjunto de testes é defendido. Neste sentido, daqui por diante, assumimos que tais condições são válidas. 

%FIXME comentar a respeito dessa hipótese, depois dos resultados numéricos
% Definimos nosso ponto inicial como

% \begin{equation}
% 	\label{eq:initial-point}
% 	(\xzero ,\yzero,\zzero ) = (\bdxzstar e, 0, \bdxzstar e ).
% \end{equation}

% Temos $\xstar_{i}\leq   \bdxzstar$, bem como $\zstar_{i}\leq \bdxzstar $, para $i=1,\ldots,n$ e por isso
% \begin{equation}
% 	\label{eq:x0}
% 0\leq x^{0} - \xstar \leq \bdxzstar e \quad \text{e} \quad 0\leq \zzero  - \zstar \leq \bdxzstar e. 
% \end{equation}



Afim de prosseguir com as demonstrações, faz-se necessário  escolher  $\gamma\in(0,1)$  e $\be\geq 1$ adequados, para construir a vizinhança $\Nset_{-\infty}(\ga,\be)$. Para o primeiro parâmetro, várias escolhas são possíveis como, por exemplo, a de 
\textcite{Colombo:2008ia} que utilizam $\ga = 1/10$. No entanto, vamos escolher $\ga$ tal que  
\[
\gamma \leq  \min\left\{ \frac{\displaystyle \min_{i}(\xzero_{i} \zzero_{i} )}{(\xzero )^T\zzero /n}, \frac{1}{10}\right\},
\]
o que garante que o ponto inicial satisfaz a desigualdade~\eqref{eq:symmetric-polynomials-b}.

Com relação à $\be$,  usando um raciocínio similar, para qualquer  $\be\geq 1$, o ponto inicial sempre satisfaz \eqref{eq:symmetric-polynomials-a}. Quanto menor for $\be$, mais acelerada é a redução  das médias dos resíduos de complementaridade, dadas por $\dbvec{\rho_C^k }$, em relação à redução da média dos resíduos de linearidade $\dbvec{\rho_L}$. Para facilitar os raciocínios, do ponto de vista teórico, vamos escolher o menor valor para $\beta$, isto é, $\be=1$.


\begin{obs}
	Em vários momentos da análise que segue vamos considerar que para qualquer terna de vetores $(\tilde{x},\tilde{y},\tilde{z})$ ,  tal que 
\begin{equation}
	\label{eq:Ax0-ATyz0}
	A\tilde{x}=0 \text{ e } A^T\tilde{y} + \tilde{z} = 0,
\end{equation}
então
\begin{equation}
	\label{eq:xTziszero}
	\tilde{x}^T\tilde{z} =  - \tilde{x}^T(A^T\tilde{y})  = -(A\Dex)^T\tilde{y} = 0.
\end{equation}
\end{obs}



% Esta análise é  baseada naquelas feitas por \textcite[cap. 6]{Wright:Primal-dual-interior-point:1997h},  \textcite{Zhang:2006ic,Zhang:1995fu}. 

O primeiro lema importante mostra a existência de um limitante para $\nu_k\norm{(\xk,\zk)}_{1}$. Uma demonstração similar, porém com condições diferentes das que aceitamos aqui, pode ser encontrada em~\cite[Lema 6.1]{Wright:Primal-dual-interior-point:1997h}, fonte da qual a transcrevemos com as adaptações pertinentes à nossa notação bem como às condições que aqui assumimos.
 % Ademais, na demonstração deste e dos outros resultados, omitiremos o índice da iteração $k$ dos vetores, para fins de clareza. 


% \subsection{Limitante para \texorpdfstring{$\nu_k_k\norm{(\xk,\zk)}_{1}$}{a norma dos iterandos}}


\begin{lema}\label{lemma:boundxz1}
	Suponha que as Condições \ref{cond:xzzero}, \ref{cond:xzstar} e \ref{cond:x0-x*+z0-z*} são válidas e seja a constante 
	\begin{equation}\label{eq:omega-0}
		\omega_{0} = \bdxzzero^{-1}\left(2  + \dfrac{\bdxzstar^{2}}{\dbvec{\rho_C^{0}}}\right) >1.
		\end{equation} 
	 Então para qualquer iterado $(\xk,\yk,\zk)$ gerado pelo Algoritmo \ref{alg:optimized-choice-of-parameters-simplified}, vale
	\begin{equation}
		\label{eq:bound-xkzk}
		\nu_k\norm{(\xk,\zk)}_{1} \leq  \omega_{0} n^{3} \dbvec{\rho_C^{k}},
	\end{equation}
	em que $\nu_k$ é definido em \eqref{eq:nu_k+1}.
\end{lema}

\begin{proof}
	Seja o ponto auxiliar
	\[
		(\tilde{x},\tilde{y},\tilde{z})  = \nu_k(\xzero,\yzero,\zzero) + (1-\nu_k)(\xstar,\ystar,\zstar) - (\xk,\yk,\zk). 
	\]
em que $(\xzero,\yzero,\zzero)$ é ponto inicial dado por \eqref{eq:initial-point-mehrotra} e $(\xstar,\ystar,\zstar)$ é  solução ótima que satisfaz \eqref{eq:norm-xz-star}.


Note que 
\[
\begin{aligned}
A\tilde{x} & = A(\nu_k\xzero+ (1-\nu_k)\xstar -\xk) = \nu_k(A\xzero - A\xstar) + A\xstar - A\xk   \\
& = \nu_k(A\xzero - b) + (b - A\xk) = -\nu_k r_{P}^{0} + r_{P}^{k}  \\
 & =r_{P}^{k} + r_{P}^{k} = 0,  
\end{aligned}
\]
e que
\[
\begin{aligned}
A^{T}\tilde{y} + \tilde{z}  & = 	A^{T}(\nu_k\yzero + (1-\nu_k)\ystar - \yk) + (\nu_k\zzero + (1-\nu_k)\zstar - \zk) \\
							&  =  \nu_k \left[(A^{T}\yzero  +\zzero)  - (A^{T}\ystar  +\zstar)  \right]+  \left[(A^{T}\ystar  +\zstar)  - (A^{T}\yk  +\zk)  \right]  \\
							& = -\nu_k r_{D}^{0} + r_{D}^{k}  \\
 & =r_{D}^{k} + r_{D}^{k} = 0.   
\end{aligned}
\]


Portando, $(\tilde{x},\tilde{y},\tilde{z})$  satisfaz \eqref{eq:Ax0-ATyz0} e então vale \eqref{eq:xTziszero}, isto é, $(\tilde{x})^{T}\tilde{z} = 0$. 

Logo temos que 
\begin{align}
	0  = \tilde{x}^{T}\tilde{z} & = (\nu_k\xzero + (1-\nu_k)\xstar -\xk)^{T}(\nu_k\zzero + (1-\nu_k)\zstar -\zk)\notag\\
	  & = \nu_k^{2}(\xzero)^T\zzero + (1-\nu_k)^{2}(\xstar)^{T}\zstar + \nu_k(1-\nu_k)((\xzero)^{T}\zstar + (\xstar)^{T}\zzero) \notag\\
	  & \textcolor{white}{=} +(\xk)^{T}\zk - \nu_k ((\xk)^{T}\zzero + (\xzero)^{T}\zk) - (1-\nu_k) ((\xk)^{T}\zstar + (\xstar)^{T}\zk).\label{eq:boundxz1}
\end{align}

Como  $(\xk,\zk)>0$ e $(\xstar,\zstar)\leq 0$, vale $((\xk)^{T}\zstar + (\xstar)^{T}\zk) \geq 0$. Além disso, $(\xstar,\ystar,\zstar)$ é uma solução ótima, e por isso $(\xstar)^{T}\zstar = 0$. Usando essas observações e levando em conta que $\nu_k\in(0,1)$,  pode-se reorganizar  a equação \eqref{eq:boundxz1} como
\begin{equation}
	\label{eq:xTzero+xzeroTz}
	  \nu_k ((\xk)^{T}\zzero + (\xzero)^{T}z) \leq 
  \nu_k^{2}(\xzero)^T\zzero  + (\xk)^{T}z+  \nu_k(1-\nu_k)((\xzero)^{T}\zstar + (\xstar)^{T}\zzero).
\end{equation}

Seja a constante $\bdxzzero>0$ dada em \eqref{eq:bdxzzero}. Como  $(\xk,\zk)>0$, segue 
\begin{equation}
	\label{eq:normxz1}
	\bdxzzero\norm{(\xk,\zk)}_{1} = \bdxzzero\left(\sum_{i=1}^{n}\xk_{i} + \sum_{i=1}^{n}\zk_{i} \right) \leq \min_{i}(\zzero_{i})\norm{\xk}_{1} + \min_{i}(\xzero_{i})\norm{\zk}_{1}\leq
(\xk)^{T}\zzero + (\xzero)^{T}\zk.
\end{equation}

Por outro lado,  para  $p = 1 $, $q = \infty$, vale a desigualdade de desigualdade de Hölder \cite[p. 53]{Golub:1996wp}, isto é, $\abs{u^{T}v} \leq \norm{u}_{1}\norm{v}_{\infty}$, para $u,v\in\Real^{n}$ quaisquer. Assim, notando que $(\xzero,\zzero)>$ e $(\xstar,\zstar)>0$, podemos dispensar o módulo e usar a desigualdade de Hölder no último termo do lado direito da desigualdade \eqref{eq:xTzero+xzeroTz} em conjunto com as  equações \eqref{eq:norm-xz-zero} e \eqref{eq:norm-xz-star}  obtendo
	\begin{align}
	(\xzero)^{T}\zstar + (\xstar)^{T}\zzero  & \leq \norm{\xzero}_{1}\norm{\zstar}_{\infty} + \norm{\zzero}_{1}\norm{\xstar}_{\infty} \notag \\
	& \leq \norm{(\xzero,\zzero)}_1 \norm{(\xstar,\zstar)}_{\infty} \notag \\
	&  \leq \bdxzstar^{2} n^3. \label{eq:norm-star-zero-infty-1} 
	\end{align}


% Além disso, pela escolha do ponto inicial, temos que 
% \begin{gather*}
% 	\norm{(\xzero,\zzero)}_\infty = \bdxzstar \label{eq:initial-conseq-a}\\
% 	\norm{(\xstar,\zstar)}_1\leq 2n\norm{(\xstar,\zstar)}_{\infty} \leq 2n \bdxzstar \label{eq:initial-conseq-b}\\
% 	(\xzero)^{T}\zzero = n\dbvec{\rho_C^0} = n\bdxzstar^{2}\label{eq:initial-conseq-c}
% \end{gather*}

Multiplicando a desigualdade  \eqref{eq:normxz1} por $\nu_k$, temos 
\[
	\nu_k\bdxzzero\norm{(\xk,\zk)}_{1} \leq \nu_k((\xk)^{T}\zzero + (\xzero)^{T}\zk),
\]
que é exatamente o lado esquerdo de \eqref{eq:xTzero+xzeroTz}. Comparando essa última desigualdade com  \eqref{eq:xTzero+xzeroTz} obtemos 
\[
	\bdxzzero\nu_k\norm{(\xk,\zk)}_{1}  \leq \nu_k^{2}(\xzero)^T\zzero  + (\xk)^{T}z+  \nu_k(1-\nu_k)((\xzero)^{T}\zstar + (\xstar)^{T}\zzero). 
\]
Agora, como  $\nu_k\in(0,1)$ implica que $\nu_{k}^{2}< \nu_{k}$ e que $\nu_k(1-\nu_k) < \nu_k$. Além disso, para qualquer $k$, $(\xk)^{T}\zk = n\dbvec{\rho_{C}^{k}}$.  Usando esses argumentos e substituindo \eqref{eq:norm-star-zero-infty-1} na última desigualdade obtemos
\[
	\bdxzzero\nu_k\norm{(\xk,\zk)}_{1} 	\leq \nu_k n\dbvec{\rho_C^0} + n\dbvec{\rho_C^{k}} + \nu_k(\bdxzstar^{2} n^3 ).  
\]

Considerando que $(\xk,\yk,\zk)$ pertence à vizinhança $\Nset_{-\infty}(\ga,\be)$, e portanto vale  \eqref{eq:nu_k-rho0-rhok}, temos que $\nu_k \dbvec{\rho_C^0} \leq \be \dbvec{\rho_C^{k}}$. 
\[
	\bdxzzero\nu_k\norm{(\xk,\zk)}_{1}   \leq \be n\dbvec{\rho_C^{k}}+ n\dbvec{\rho_C^{k}} + \be\left(\dbvec{\rho_C^{k}}/\dbvec{\rho_C^{0}}\right)(\bdxzstar^{2} n^3  ). 
\]Já que escolhemos $\be=1$, obtemos 
\begin{align*}
	\bdxzzero\nu_k\norm{(\xk,\zk)}_{1}  & \leq 2 n\dbvec{\rho_C^{k}}+ \left(\dbvec{\rho_C^{k}}/\dbvec{\rho_C^{0}}\right)(\bdxzstar^{2} n^3  ) \\	
								 &= \left(\frac{2}{n^{2}}  + \frac{\bdxzstar^{2}}{\dbvec{\rho_C^{0}}}\right)  n^{3}\dbvec{\rho_C^{k}} \\
								 &  \leq \left(2  + \frac{\bdxzstar^{2}}{\dbvec{\rho_C^{0}}}\right)  n^{3}\dbvec{\rho_C^{k}}.								
\end{align*}
Fazendo $\omega_{0} = \bdxzzero^{-1}\left(2  + \dfrac{\bdxzstar^{2}}{\dbvec{\rho_C^{0}}}\right)$, obtemos o resultado desejado.
\end{proof}

% e \eqref{eq:norm-star-zero-infty-1} 
% Considerando que $(\xk,\yk,\zk)$ pertence à vizinhança $\Nset_{-\infty}(\ga,\be)$, e portanto vale  \eqref{eq:nu_k-rho0-rhok}, e ainda  e que escolhemos $\be=1$, obtemos



\subsection{Limitantes paras normas de direções} 

A próxima proposição será utilizada nas demonstrações que seguem e é um fato conhecido e bastante utilizado em \ac{MPI}.

\begin{prop}\label{prop:norm-uv}
	Seja $D$ uma matriz diagonal não-singular de ordem $n$ e sejam $u,v\in\Real^n$, então 
	\begin{equation}
		\label{eq:prop-uvDuDv}
		\norm{uv}\leq \norm{uv}_1 \leq \norm{Du}\norm{D^{-1}v} \leq \frac{1}{2}\left(\norm{Du}^{2} + \norm{D^{-1}v}^{2}\right)
	\end{equation}
\end{prop}
\begin{proof} A primeira desigualdade é valida por conta da equivalência de normas~\cite{Golub:1996wp}. Quanto às demais, vejamos que 
	\begin{align*}
		\norm{uv}_1^{2} & = \left( \sum_{i=1}^{n}u_i v_i  \right)^{2} \leq  \sum_{i=1}^{n}\abs{u_iv_i}^{2}\\
						& = \norm{uv}^{2} = (uv)^{T}(uv)  = v^{T}D^{-T}D^{T}u^{T}DD^{-1} uv\\
						& = v^{T}D^{-T}D^{T}u^{T}DuD^{-1}v\\
						& = \norm{Du}^{2}\norm{D^{-1}v}^{2}.
	\end{align*}
e logo a segunda desigualdade de \eqref{eq:prop-uvDuDv} está provada. 

Com relação a terceira desigualdade, note que  
\[
0 \leq \left(\norm{Du}^{1} - \norm{D^{-1}v}^{2}\right)^{2} = \norm{Du}^{2} - 2\norm{Du}\norm{D^{-1}v} + \norm{D^{-1}v}^{2}
\]
e portanto temos a validade de
\[
\norm{Du}\norm{D^{-1}v} \leq \frac{1}{2}\left(\norm{Du}^{1} + \norm{D^{-1}v}^{2}\right). \qedhere
\]
\end{proof}

De agora em diante, dados $(\xk,\zk)$ gerado pelo Algoritmo, definimos a matriz $\Dk$ como sendo
\[
\Dk =(\Xk)^{-1/2}(\Zk)^{1/2}.
\]

Assim, podemos enunciar o seguinte lema.

\begin{lema}\label{lemma:boundDxDzaff}
	Suponha que as Condições \ref{cond:xzzero}, \ref{cond:xzstar} e \ref{cond:x0-x*+z0-z*} são válidas. Então existe uma constante $\omega_1>1$   independente de $n$ tal que 
	\begin{equation}
		\norm{\Dk  \dekx }\leq \omega_1 n^5\dbvec{\rho_C^{k}}^{1/2}\text{ e } \quad  \norm{\Dik  \dekz  }\leq \omega_1 n^5\dbvec{\rho_C^{k}}^{1/2}.
	\end{equation}
\end{lema}
\begin{proof}
	Seja o ponto auxiliar
	\[
		(\tilde{x},\tilde{y},\tilde{z})  = ( \dekx,  \deky  ,  \dekz  ) + \nu_k(\xzero - \xstar,\yzero - \ystar,\zzero - \zstar), 
	\]
em que $(\xzero,\yzero,\zzero)$ é ponto inicial dado por \eqref{eq:initial-point-mehrotra} e que satisfaz \eqref{eq:norm-xz-zero} e  $(\xstar,\ystar,\zstar)$ é  solução ótima que satisfaz \eqref{eq:norm-xz-star}.
	Tal ponto satisfaz \eqref{eq:Ax0-ATyz0} e logo 
	\begin{equation}
		\label{eq:DxDzaff1}
			 0 = \tilde{x}^{T}\tilde{z} = \left( \dekx +  \nu_k(\xzero - \xstar)\right)^{T}\left(  \dekz   +  \nu_k(\zzero - \zstar)\right).
	\end{equation}
	

	 Usando este ponto auxiliar na equação \eqref{eq:affine-scaling-system-compl}, obtemos 
	 \[
	 \Zk\left( \dekx +  \nu_k(\xzero - \xstar)\right)+ \Xk \left(  \dekz   +  \nu_k(\zzero - \zstar)\right) = -\xk\zk + \nu_k \Zk(\xzero - \xstar) + \nu_k \Xk(\zzero - \zstar).
	 \]
	 Multiplicando toda essa expressão por $(\Xk\Zk)^{-1/2}$, e notando que $\Dk=(\Xk\Zk)^{-1/2}\Zk$ e que $\Dik=(\Xk\Zk)^{-1/2}\Xk$, resulta em 
	\begin{multline}
		\label{eq:DxDzaff2}
		 \Dk\left( \dekx  +  \nu_k(\xzero - \xstar)\right)+ \Dik \left(  \dekz   +  \nu_k(\zzero - \zstar)\right) = \\ -(\xk\zk)^{1/2} + \nu_k \Dk(\xzero - \xstar) + \nu_k \Dik(\zzero - \zstar).
		\end{multline}
	 
	 Note que, como vale  \eqref{eq:DxDzaff1}, pode-se utilizar o Teorema de Pitágoras para norma-2 de vetores e logo, tomando a norma-2 ao quadrado do lado esquerdo de \eqref{eq:DxDzaff2} obtemos
	\begin{multline*}
			 	 \norm{\Dk\left( \dekx +  \nu_k(\xzero - \xstar)\right)+ \Dik \left( \dekz  +  \nu_k(\zzero - \zstar)\right)}^{2} =\\
	 	 	 	 	 \norm{\Dk\left( \dekx +  \nu_k(\xzero - \xstar)\right)}^{2}+ \norm{\Dik \left( \dekz  +  \nu_k(\zzero - \zstar)\right)}^{2}.
	\end{multline*}
	 Se  usarmos este resultado e a desigualdade triangular, após tomarmos a norma-2 ao quadrado de ambos os lados de \eqref{eq:DxDzaff2}, obtemos 
	 \begin{multline}\label{eq:DxDzaff3}
	 \norm{\Dk\left( \dekx +  \nu_k(\xzero - \xstar)\right)}^{2}+ \norm{\Dik \left( \dekz  +  \nu_k(\zzero - \zstar)\right)}^{2} \leq \\ 
	 \left\{ \norm{(  \xk \zk   )^{1/2}} + \nu_k \norm{\Dk(\xzero - \xstar)} + \nu_k \norm{\Dik(\zzero - \zstar)} \right\}^{2}.
	 \end{multline}

Isolando o primeiro termo dessa equação, obtemos
\[
\norm{\Dk\left( \dekx +  \nu_k(\xzero - \xstar)\right)} \leq  
	  \norm{(  \xk \zk  )^{1/2}} + \nu_k \norm{\Dk(\xzero - \xstar)} + \nu_k \norm{\Dik(\zzero - \zstar)}.
\]
Uma aplicação direta da desigualdade triangular e a adição de um termo  $\nu_k \norm{\Dik(\zzero - \zstar)}$ extra resulta em
\begin{align}
	\norm{\Dk \dekx} & =  \norm{\Dk\left( \dekx  +  \nu_k(\xzero - \xstar)  -  \nu_k(\xzero - \xstar)\right)} \notag \\ 
				 & \leq	 \norm{\Dk\left( \dekx  +  \nu_k(\xzero - \xstar)\right)} +  \nu_k\norm{\Dk(\xzero - \xstar)} \notag \\
				 & \leq \norm{(  \xk \zk  )^{1/2}} + 2 \nu_k \norm{\Dk(\xzero - \xstar)} + 2\nu_k \norm{\Dik(\zzero - \zstar)}.\label{eq:DxDzaff4}
\end{align}

Vamos mostrar a existência de um limitante para cada termo do lado direito de \eqref{eq:DxDzaff4} de magnitude $\Oset\left(\dbvec{\rho_C^k}^{1/2}\right)$. Neste caso, o mesmo se aplicará à $\norm{\Dik \dekz }$ o que finalizará esta demonstração.

Para o primeiro termo, note que 
\begin{equation}
	\label{eq:DxDzaff5}
	\norm{(  \xk \zk  )^{1/2}} = \left(\sum_{i=1}^{n}\xk_i \zk_i\right)^{1/2} = ((\xk)^{T}\zk)^{1/2} = n^{1/2}\dbvec{\rho_C^k }^{1/2} \leq \frac{n}{\ga^{1/2}}\dbvec{\rho_C^k }^{1/2},
\end{equation}
já que $\ga\in(0,1)$ e $\sqrt{n}\leq n$, para todo $n$ natural.

% Para os últimos dois termos, considere primeiro que a vale a Condição \ref{cond:x0-x*+z0-z*} e portanto 
% \[
% \norm{\xzero - \xstar} \leq \bdxzstar n^2, \text{ bem como } \norm{\zzero - \zstar} \leq \bdxzstar n^2.
% \]

A norma-2 da matriz  $\Dk$ será
\[
 \norm{\Dk} = \max_{i=1,\ldots,n} \abs{\Dk_{ii}} = \norm{\Dk e}_{\infty} = \norm{(\Xk\Zk)^{-1/2}z}_{\infty} \leq \norm{(\Xk\Zk)^{-1/2}}\norm{\zk}_{1},
\]
e similarmente
\[
\norm{\Dik} \leq  \norm{(\Xk\Zk)^{-1/2}} \norm{\xk}_{1}.
\]

Mais que isso, como $(\xk,\yk,\zk)\in\Nset_{-\infty}(\ga,\be)$, temos que 
\begin{equation}
\label{eq:DxDzaff6}
	\norm{(\Xk\Zk)^{-1/2}} = \max_{i=1,\ldots,n}\frac{1}{(\xk_i\zk_i)^{1/2}} \leq \frac{1}{\ga^{1/2}\dbvec{\rho_{C}^k}^{1/2}}.
\end{equation}

Com essas desigualdades para norma de $\Dk$ e de $\Dik$, utilizando consistência de norma de matrizes e a Condição \ref{cond:x0-x*+z0-z*}, segue 
\begin{align*}
 \nu_k \norm{\Dk(\xzero - \xstar)} + \nu_k \norm{\Dik(\zzero - \zstar)}  & \leq \nu_k \norm{\Dk}\norm{\xzero - \xstar} + \nu_k \norm{\Dik}\norm{\zzero - \zstar} \notag \\
 					& \leq \bdxzstar n^2 \nu_k\left[  \norm{\Dk} + \norm{\Dik}   \right] \notag \\ 
 					& \leq \bdxzstar n^2 \nu_k\norm{(\xk,\zk)}_{1}\norm{(\Xk\Zk)^{-1/2}} .\notag
\end{align*}

Da equação~\eqref{eq:DxDzaff6}, do Lema~\ref{lemma:boundxz1} e da desigualdade acima, segue que 
\begin{equation} \label{eq:DxDzaff7}
 \nu_k \norm{\Dk(\xzero - \xstar)} + \nu_k \norm{\Dik(\zzero - \zstar)}  \leq \bdxzstar n^2 \omega_{0} n^{3} \dbvec{\rho_C^{k}}\frac{1}{\ga^{1/2}\dbvec{\rho_{C}^k}^{1/2}} \leq   \frac{\bdxzstar  \omega_{0}}{\ga^{1/2}} n^{5} \dbvec{\rho_C^{k}}^{1/2} .
\end{equation}

Se usarmos as equações \eqref{eq:DxDzaff5} e \eqref{eq:DxDzaff7}, comparando-as com \eqref{eq:DxDzaff4} temos que 
\begin{align*}
\norm{\Dk \dekx} & \leq \frac{n}{\ga^{1/2}}\dbvec{\rho_C^k }^{1/2} +  \frac{2\bdxzstar  \omega_{0}}{\ga^{1/2}} n^{5} \dbvec{\rho_C^{k}}^{1/2} \\
				& = \left( \frac{1}{n^{4}\ga^{1/2}} +  \frac{2\bdxzstar  \omega_{0}}{\ga^{1/2}} \right)n^{5} \dbvec{\rho_C^{k}}^{1/2}\\
				& \leq \frac{1 + 2\bdxzstar  \omega_{0}}{\ga^{1/2}} n^{5} \dbvec{\rho_C^{k}}^{1/2}.
\end{align*}
Podemos definir
\begin{equation}
	\label{eq:omega1}
	\omega_1 = \frac{1 + 2\bdxzstar  \omega_{0}}{\ga^{1/2}},
\end{equation}
e como  $\ga\in(0,1)$, temos que $\omega_1>1$ como requisitado.
\end{proof}

Um corolário  das desigualdades dadas pela Proposição~\ref{prop:norm-uv} e do Lema~\ref{lemma:boundDxDzaff} acima é que 
\begin{multline}
\label{eq:normDxDzaff}
	\norm{ \dekx  \dekz  } \leq \norm{ \dekx  \dekz  }_{1}  \\ \leq \frac{1}{2}\left(\norm{\Dk \dekx}^{2} + \norm{\Dik  \dekz  }^{2}\right)
  					 \leq \left(\omega_1 n^5\dbvec{\rho_C^{k}}^{1/2}\right)^{2}
  					 = \omega_1^{2} n^{10}\dbvec{\rho_C^{k}}.
\end{multline}

\begin{lema}\label{lemma:boundDxDzc}
	Suponha um ponto inicial escolhido como em \eqref{eq:initial-point-mehrotra} e que \begin{equation}
	\label{eq:sig-eta-relation}
	\nextsig \geq \frac{\sqrt{\ga} - \eta}{\omega_1^{2}}.
\end{equation} Então existe uma constante $\omega_2\geq1$  independente de $n$ tal que 
	\begin{equation}\label{eq:lemma-boundDxDzcx}
		\norm{\Dk(\Decox)^{k}}^{2} + \norm{\Dik(\Decoz)^{k}}^{2} \leq \omega_2 n^{4}\dbvec{\rho_C^{k}}.
	\end{equation}
\end{lema}



\begin{proof}
	Note que por conta de \eqref{eq:linear-sytem-DeXDeZcorrec}, temos que $(\Decox,\Decoy,\Decoz)$ satisfaz \eqref{eq:Ax0-ATyz0} e logo $(\Decox)^{T}\Decoz = 0$. 

	


	Além disso, também por causa de \eqref{eq:linear-sytem-DeXDeZcorrec}, temos que
	\[
	z\Decox + x\Decoz = \mu e  - \sig \dekx  \dekz .
	\]

	Multiplicando toda equação anterior por $(  \xk \zk  )^{-1/2}$ e  fixando $\mu = \nextmu$ e $\sig = \nextsig $, segue que 
	\[
		\Dk\Decox + \Dik\Decoz = (  \xk \zk  )^{-1/2}(\nextmu e + \nextsig \dekx  \dekz ).
	\] 

	Por um lado temos que 
	\[
		\norm{\Dk\Decox + \Dik\Decoz}^{2} = \norm{\Dk\Decox}^{2} + \norm{\Dik\Decoz}^{2} + 2(\Decox)^{T}\Decoz = \norm{\Dk\Decox}^{2} + \norm{\Dik\Decoz}^{2}.
	\]

Assim, usando consistência de normas e o fato de que  $(x,y,z)\in\Nset_{-\infty}(\ga,\be))$ obtemos
\begin{align}
	\norm{\Dk\Decox}^{2} + \norm{\Dik\Decoz}^{2} & = \norm{(  \xk \zk  )^{-1/2}(\nextmu e+ \nextsig \dekx  \dekz )}^{2} \notag\\ 
												& \leq \norm{(  \xk \zk  )^{-1/2}}^{2}\norm{(\nextmu e+ \nextsig \dekx  \dekz )}^{2} \notag\\ 
												& \leq \min\left({x_iz_i}\right)^{-1}\left(\nextmu\norm{ e} +{\nextsig}\norm{ \dekx  \dekz }\right)^{2}\notag\\
												& \leq (\ga\dbvec{\rho_C^k })^{-1}\left(\nextmu\sqrt{n} +{\nextsig}\norm{ \dekx  \dekz }\right)^{2} \label{eq:DxDzc1}		
\end{align}



Utilizando as desigualdades de \eqref{eq:normDxDzaff}, fixando $\mu = \nextmu =\eta \dbvec{\rho_C^k }$ como anteriormente e notando que para todo $n$ natural vake $\sqrt{n} \leq n^{2}$, o lado esquerdo de~\eqref{eq:DxDzc1} é tal que
\begin{align*}
	% (\ga\dbvec{\rho_C^k })^{-1}\left(\nextmu\sqrt{n} +\abs{\nextsig}\norm{ \dekx  \dekz }\right)^{2}  
	\norm{\Dk\Decox}^{2} + \norm{\Dik\Decoz}^{2}
							& \leq (\ga\dbvec{\rho_C^k })^{-1}\left(\eta\dbvec{\rho_C^k }\sqrt{n} +{\nextsig} \omega_1^{2} n^{2}\dbvec{\rho_C^k }\right)^{2}\\
							& \leq (\ga)^{-1}\left(\eta\sqrt{n} +{\nextsig} \omega_1^{2} n^{2}\right)^{2}\dbvec{\rho_C^k }\\
							& \leq (\ga)^{-1}\left(\eta +{\nextsig} \omega_1^{2} \right)^{2}n^{4}\dbvec{\rho_C^k }.
\end{align*}

Seja
\begin{equation}
\label{eq:omega2}
	\omega_2 = \frac{\left(\eta +{\nextsig} \omega_1^{2} \right)^{2}}{\ga}.
	\end{equation}
Observando que  $\omega_1 \geq 1/10$ e  $\ga\in(0,1)$,  se $\eta\in[0,1]$ e se \eqref{eq:sig-eta-relation} for satisfeita, então garante-se que $\omega_2\geq 1$, como queríamos. \qedhere
% \begin{equation}
% 	\label{eq:sig-eta-relation}
% 	\nextsig \geq \frac{\sqrt{\ga} - \eta}{\omega_1^{2}},
% \end{equation}




% Wolphran Alpha code
% solve{ (1/gamma)*(eta +sigma*omega^2)^2>=1 , gamma<1, omega>=1, sigma}
%with abs(sigma)
%solve{ (1/gamma)*(eta +abs(sigma)*omega^2)^2>=1 , gamma<1, omega>=1, sigma}
%sigma>0
% solve{ (1/gamma)*(eta +(sigma)*omega^2)^2>=1 , gamma<1, omega>=1, sigma>0, sigma}

\end{proof}

\begin{lema}\label{lemma:boundDxDzaff-c}
	Suponha um ponto inicial escolhido como em \eqref{eq:initial-point-mehrotra}. Então 
	\begin{equation}\label{eq:lemma-boundDxDzaff-c}
		\norm{ \dekx(\Decoz)^{k} + (\Decox)^{k}  \dekz  }_{1} \leq  \tfrac{1}{2}\omega_{3}n^{3}\dbvec{\rho_C^{k}},
	\end{equation}
em que $\omega_{3} = 4(\omega_1\omega_2^{1/2})\geq 4 $.
\end{lema}

\begin{proof}
	Da equação \eqref{eq:prop-uvDuDv} e dos Lemas~\ref{lemma:boundDxDzaff} e \ref{lemma:boundDxDzc} segue que  
	\begin{align*}	
		\norm{ \dekx \Decoz}_{1} & \leq \norm{\Dk \dekx }\norm{\Dik\Decoz}\\
							  & \leq 	\omega_1 n\dbvec{\rho_C^k }^{1/2}(\omega_2 n^{4}\dbvec{\rho_C^k })^{1/2}  \\
							  & = (\omega_1\omega_2^{1/2})n^{3}\dbvec{\rho_C^k }.
	\end{align*}			  
Similarmente, 	$\norm{\Decox \dekz }_{1} \leq (\omega_1\omega_2^{1/2})n^{3}\dbvec{\rho_C^k }$. Com isso temos o resultado desejado, isto é,
\[
		\norm{ \dekx \Decoz + \Decox \dekz }_{1} \leq 2(\omega_1\omega_2^{1/2})n^{3}\dbvec{\rho_C^k }.\qedhere
\]
\end{proof}

\section{Teorema de Convergência}

A fim de que o Algoritmo~\ref{alg:optimized-choice-of-parameters-simplified} esteja bem definido, é necessário que exista para cada iteração $k$ uma tripla $(\al_k,\mu_k,\sig_k)$, de modo que seja possível encontrar um próximo ponto $(\nextx,\nexty,\nextz)$. Com efeito, considerando que fixamos os valores de $\mu$ e $\sig$ como $\nextmu $ e  $\nextsig$, basta encontrar um  tamanho de passo ${\al_k}>0$ tal que o próximo ponto $(\nextx,\nexty,\nextz)$ satisfaça as restrições da vizinhança 
$\Nset_{-\infty}(\gamma,\beta)$ e além disso, garanta que  $0 < \theta(\al_k) <1$. É o que os próximos resultados garantem. Observe que, por conta de \eqref{eq:sig-eta-relation}, garantiremos que $\eta>\sqrt{\ga}$.



\begin{lema}\label{lemma:alC_delta-1}
Seja $\nextal_{C}$ dado em \eqref{eq:al-C+al-L}. Então 
\[
\nextal_{C} \geq \delta_{1}/n^{4}
\]
em que 
\[
\delta_{1} = \dfrac{(1-\ga)\eta}{2\om_{1}^{2} + \om_{2}/2 + \om_{3}  } < 1.
\]
\end{lema}

\begin{proof}
 Primeiramente, considere que  utilizando a Equação \eqref{eq:simplified-merit-function-al}, é possível rescrever a função $g_C^i $, para $i=1,\ldots,n$, que foi dada em \eqref{eq:g-Ci_explicit}, somente dependendo de uma escolha de $\al$. De fato, tal função pode ser escrita escrita nos seguintes termos
\[
\begin{aligned}
{g}_C^i (\al)				& = (1-\al)(\rho_C^k )_i+ \al\eta\dbvec{\rho_C^k }+ \al^2\left[(L_{0,0})_i + \eta\dbvec{\rho_C^k } ({L_{1,0}})_i 
				+ (\eta\dbvec{\rho_C^k })^2(L_{2,0})_i \right]  + \\
				& \quad -\ga\left[  (1-\al)\dbvec{\rho_C^k } + \al\eta\dbvec{\rho_C^k } + \al^2\left(\dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}}.
\right)  \right]
\end{aligned}
\]

Sejam as constantes
\begin{equation}
\label{eq:defin-zeta-i+chi-i+xi-i}
	\begin{aligned}
\zeta_i & = (L_{0,0})_i - \ga \dbvec{L_{0,0}}, \\
\chi_i  & = \eta\dbvec{\rho_C^k } \left( ({L_{1,0}})_i - \ga\dbvec{L_{1,0}} \right),   \\
\xi_i	& =  (\eta\dbvec{\rho_C^k })^2(L_{2,0})_i . \\ 	
\end{aligned}
\end{equation}



Usando o fato de que o ponto atual pertence à vizinhança $\Nset_{-\infty}(\gamma,\beta)$, e as definições da Equação~\eqref{eq:defin-zeta-i+chi-i+xi-i} reescreve-se  $g_C^i(\al) $ como
\[
\begin{aligned}
	g_C^i (\al) & = \underbrace{(1-\al)((\rho_C^k )_i - \ga\dbvec{\rho_C^k })}_{\geq 0}  + (1-\ga)\eta\dbvec{\rho_C^k } \al+  (\zeta_i + 				\chi_i + \xi_i)\al^2  \\
				& \geq (1-\ga)\eta\dbvec{\rho_C^k } \al +  (\zeta_i + 				\chi_i + \xi_i)\al^2 \\ 
				& \geq (1-\ga)\eta\dbvec{\rho_C^k } \al -  (\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i})\al^2 \\
				& = \al \left[	(1-\ga)\eta\dbvec{\rho_C^k }  -  (\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i})\al	\right] = h^i(\al),
\end{aligned}
\]
em que $h^i$ é uma quadrática côncava em função de $\al$ com uma raiz nula e uma positiva. 

Considere, para as substituições que seguem, as definições dos vetores $L_{i,j}$ dadas em~\eqref{eq:defining-Lij}. Neste caso, da Equação~\eqref{eq:normDxDzaff}  vem que  
\begin{align}
\abs{\zeta_i} & = \abs{(L_{0,0})_i - \ga \dbvec{L_{0,0}}} \leq \abs{(L_{0,0})_i} + \ga \abs{\dbvec{L_{0,0}}} \notag \\
			  & \leq	\norm{L_{0,0}}_1  + \dfrac{\ga}{n}\norm{L_{0,0}}_1   \leq 2\norm{L_{0,0}}_1 \notag \\
			  & = 2\norm{ \dekx  \dekz }_1   \leq 2\omega_1^{2} n^{2}\dbvec{\rho_C^k }. \label{eq:bound-zeta-i}
\end{align}
Como $\sig = \nextsig=0$, usando a equação \eqref{eq:Corrector-spllited} e sabendo que $\mu=\nextmu = \eta\dbvec{\rho_{C}}$ fixado, temos que 
	\[
		\eta\dbvec{\rho_{C}}\Dex^\mu =  \nextmu\Dex^\mu = \Decox   \quad \text{ e } \quad \eta\dbvec{\rho_{C}}\Dez^\mu=  \nextmu\Dez^\mu=  \Decoz .
	\]
	Assim, do Lema~\ref{lemma:boundDxDzaff-c} segue que
\begin{align}
	\abs{\chi_i }  	& = \abs{\eta\dbvec{\rho_C^k } \left( ({L_{1,0}})_i - \ga\dbvec{L_{1,0}} \right)} \leq \abs{\eta\dbvec{\rho_C^k }  ({L_{1,0}})_i} + \ga\abs { \eta\dbvec{\rho_C^k }\dbvec{L_{1,0}}} 
					\notag \\
					&\leq \norm{\eta\dbvec{\rho_C^k }  L_{1,0}}_1 + \dfrac{\ga}{n}\norm{\eta\dbvec{\rho_C^k }  L_{1,0}}_1 \notag\\
					& \leq \norm{ \dekx \Decoz + \Decox \dekz }_1 + \dfrac{\ga}{n}\norm{ \dekx \Decoz + \Decox \dekz }_1 \notag\\
					& \leq 2 \norm{ \dekx \Decoz + \Decox \dekz }_1  \leq \omega_{3}n^{3}\dbvec{\rho_C^k }. \label{eq:bound-chi-i}
\end{align}
Se utilizarmos  a equação \eqref{eq:Corrector-spllited}, novamente com as escolhas $\sig = \nextsig=0$ e $\mu=\nextmu = \eta\dbvec{\rho_{C}}$ temos
\[
	(\eta\dbvec{\rho_C^k })^2(L_{2,0}) = (\eta\dbvec{\rho_C^k }\Dex^\mu)(\eta\dbvec{\rho_C^k }\Dez^\mu) = \Decox\Decoz.
\]
Portanto, do Lema~\ref{lemma:boundDxDzc} e da Proposição~\ref{eq:prop-uvDuDv} vem que
\begin{equation}\label{eq:bound-xi-i}
	\abs{\xi_i}	 =  \abs{(\eta\dbvec{\rho_C^k })^2(L_{2,0})_i}  = \abs{(\Decox\Decoz)_i} \leq \norm{\Decox\Decoz}_1 \leq \tfrac{1}{2} \omega_2 n^{4}\dbvec{\rho_C^k }.
\end{equation}
	


Agora, note que, para $\al>0$ e $i=1,\ldots,n$, se $h^i(\al)\geq0$ então $g_C^i(\al)\geq 0$. 

Com efeito, a única raiz positiva de $h^i$ é dada por
\[
\al_{C}^i = \dfrac{(1-\ga)\eta\dbvec{\rho_C^k }}{\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i}}
\]
e $h^i(\al)\geq 0$ sempre que $\al\in[0,\al_{C}^i].$ 

Como $\nextal^{i}_{C}$, dada em \eqref{eq:al-C+al-L}, é o maior número em $(0,1]$ tal que $g_{C}^{i}(\al)\geq 0$, para $\al\leq\nextal^{i}_{C}$, e além disso para todo $\al$ vale $g_{C}^{i}(\al) \geq h^{i}(\al)$, claramente $\nextal^{i}_{C} \geq  \al_{C}^i$ para todo $i=1,\ldots,n$.

Consequentemente, utilizando \eqref{eq:bound-zeta-i}, \eqref{eq:bound-xi-i} e \eqref{eq:bound-chi-i} temos que 
\[
\begin{aligned}
\nextal_{C}^i & \geq \left(\dfrac{(1-\ga)\eta}{2\om_{1}^{2}/n^{2} + \om_{2}/2 + \om_{3}/n  }\right)\dfrac{1}{n^{4}} \\			  & \geq \left(\dfrac{(1-\ga)\eta}{2\om_{1}^{2} + \om_{2}/2 + \om_{3}  }\right)\dfrac{1}{n^{4}},
\end{aligned}
\]
 para todo $i=1,\ldots,n$. 
 % O lema fica provado, considerando que para algum $j\in\{1,\ldots,n\}$, $ \al_{C}^{j}=\nextal_{C} $.
 \end{proof}






\begin{lema}\label{lemma:alL_delta-2}
Seja $\nextal_{L}$ dado em \eqref{eq:al-C+al-L}. Então 
\[
\nextal_{L} \geq \delta_{2}/n^{2}
\]
em que 
\[
\delta_{2} = \frac{\eta }{\om_{1}^{2} + \om_{3}/2} < 1.
\]
\end{lema}


\begin{proof}

Usando as mesmas substituições de $\nextmu$ e $\nextsig$, a função $g_L$ dada em \eqref{eq:g-L_explicit} torna-se uma função que depende apenas de $\al$, nos seguintes termos 
\[
g_L(\al) =     (1-\al)\left(\dbvec{\rho_C^k } -  \be_L \nu_k   \right) +  \al\eta\dbvec{\rho_C^k } + 
   \al^2\left( \dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k }  \dbvec{L_{1,0}}   \right ) ,
	\]
Usando  o fato de que o ponto atual pertence à  vizinhança segue que 
 \[
\begin{aligned}
{g}_L(\al) & =     (1-\al)\underbrace{\left(\dbvec{\rho_C^k } -  \be_L \nu_k   \right)}_{\geq 0} +  \al\eta\dbvec{\rho_C^k } + 
   \al^2\left( \dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k }  \dbvec{L_{1,0}}   \right ) \\
   & \geq  \al\left[\eta\dbvec{\rho_C^k } - 
   \al \left(\abs{\dbvec{L_{0,0}}} + \abs{\eta\dbvec{\rho_C^k }  \dbvec{L_{1,0}}}\right)   \right ].
\end{aligned}
 \]
Note que  $\nextal_L\in(0,1]$ -- definido em \eqref{eq:al-C+al-L} -- é o maior número tal que  $g_L(\al)\geq 0$, para  $\al\in[0,\nextal_L]$. Por conta da última inequação acima, temos que 
\begin{equation}
	\label{eq:next-al-ineq}
\nextal_L \geq \frac{\eta\dbvec{\rho_C^k } }{\abs{\dbvec{L_{0,0}}} + \abs{\eta\dbvec{\rho_C^k }  \dbvec{L_{1,0}}}}.
\end{equation}
Da Equação~\eqref{eq:normDxDzaff}  vem que  
\begin{align}
\abs{\dbvec{L_{0,0}}} &  = \abs{\dfrac{( \dekx )^T \dekz }{n}} \notag \\
			& \leq \dfrac{1}{n} \norm{ \dekx  \dekz }_1  \leq  \omega_1^{2} n\dbvec{\rho_C^k }\label{eq:bound-zeta}
\end{align}
Novamente, fazemos $\sig = \nextsig=0$ e  $\mu=\nextmu = \eta\dbvec{\rho_{C}}$. Usando a equação \eqref{eq:Corrector-spllited} temos que 
	\[
		\eta\dbvec{\rho_{C}}\Dex^\mu =  \nextmu\Dex^\mu = \Decox   \quad \text{ e } \quad \eta\dbvec{\rho_{C}}\Dez^\mu=  \nextmu\Dez^\mu=  \Decoz .
	\]
	Assim, do Lema~\ref{lemma:boundDxDzaff-c} segue que
	\begin{align}
	\abs{\eta\dbvec{\rho_C^k } \dbvec{L_{1,0}}} & = \abs{\dfrac{( \dekx )^T(\nextmu\Dez^\mu) + (\nextmu\Dex^\mu)^T \dekz }{n}   }  \notag \\ 
	&  = \abs{\dfrac{( \dekx )^T(\Decoz) + (\Decox)^T \dekz }{n} } \notag \\
	& \leq \dfrac{1}{n} \norm{ \dekx \Decoz + \Decox \dekz }_1 \notag\\
	&\leq \tfrac{1}{2}\omega_{3}n^{2}\dbvec{\rho_C^k }.\label{eq:bound-chi}
	\end{align}

A prova do lema termina por juntar a Equação \eqref{eq:next-al-ineq} com \eqref{eq:bound-zeta} e \eqref{eq:bound-chi}, derivando 
\[
\nextal_L \geq \left( \frac{\eta }{\om_{1}^{2}/n + \om_{3}/2}\right)\dfrac{1}{n^{2}}. \qedhere
\]
\end{proof}


\begin{lema}\label{lemma:next-phi-delta-n4}
A sequência $\{(x^{k},y^{k},z^{k})\}$ gerada pelo Algoritmo~\ref{alg:optimized-choice-of-parameters-simplified} é tal que
\begin{equation}
		\label{eq:varphi-delta-n4}
				\varphi_{k+1}\leq \left(1 - \frac{\hat{\delta}}{n^{4}}\right)\varphi_{k},
	\end{equation}
	para todo $k$, em que 
	\begin{equation}
		\label{eq:nextdel}
		 \nextdel =(1 -  \eta)\delta_{1} - \delta_{1}^{2}\left(\omega_1^{2} + \tfrac{1}{2}\omega_{3} \right).
	\end{equation}
\end{lema}


\begin{proof} Por conta da Equação \eqref{eq:nex-al}, e dos Lemas \ref{lemma:alC_delta-1} e \ref{lemma:alL_delta-2}, podemos escolher, sem perda de generalidade, $\nextal = \delta_{1}/n^{4}$. Com isso, basta mostrar que $\theta(\nextal)= \Oset(\nextdel/n^{4})$. Com efeito, considerando que $\dfrac{\dbvec{\rho_C^k }}{\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k }}\leq 1$ temos que


\[
	\begin{aligned}
		\theta(\nextal)% & =  \dfrac{1}{\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k }}\left[ \nu_k\dbvec{\rho_L}_0\nextal + (1- \eta)\dbvec{\rho_C^k }\nextal - \nextal^{2}\left(\dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}} \right) \right] \\
						& = \dfrac{1}{\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k }}\left[ (\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k })\nextal -  \eta\dbvec{\rho_C^k }\nextal - \nextal^{2}\left(\dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}} \right) \right] \\
						& \geq \dfrac{1}{\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k }}\left[ (\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k })\nextal -  \eta\dbvec{\rho_C^k }\nextal - \nextal^{2}\left(\omega_1^{2} n\dbvec{\rho_C^k } + \tfrac{1}{2}\omega_{3}n^{2}\dbvec{\rho_C^k } \right) \right]\\
						& \geq \nextal - \dfrac{\dbvec{\rho_C^k }}{\nu_k\dbvec{\rho_L}_0 + \dbvec{\rho_C^k }} \left[   \eta\nextal + \nextal^{2}\left(\omega_1^{2} n + \tfrac{1}{2}\omega_{3}n^{2} \right) \right]\\
						& \geq \nextal \left[ 1 -  \eta - \nextal\left(\omega_1^{2} n + \tfrac{1}{2}\omega_{3}n^{2} \right) \right] \\
						& \geq \frac{\delta_{1}}{n^{4}} \left[ 1 -  \eta - \frac{\delta_{1}}{n^{4}}\left(\omega_1^{2} n + \tfrac{1}{2}\omega_{3}n^{2} \right) \right] \\
						& \geq 	 \left[ (1 -  \eta)\delta_{1} - \delta_{1}^{2}\left(\omega_1^{2} + \tfrac{1}{2}\omega_{3} \right) \right] \frac{1}{n^{4}}	\\
						& = \frac{\nextdel}{n^{4}},		
		\end{aligned}
	\]
	com 	$\nextdel$ dado na Equação \eqref{eq:nextdel}. A demonstração será finalizada ao mostrarmos que $0<\nextdel<1$.

	Com efeito, ao utilizarmos as equações \eqref{eq:omega1}, \eqref{eq:omega2} e o Lema \ref{lemma:boundDxDzaff-c}, encontramos o valor de $\nextdel$ a depender das constantes $\ga$ e $\eta$, ou seja, 
	\begin{equation}
		\label{eq:nextdel-full}
		\nextdel = \frac{(2\ga\eta)(1-\ga)(324 -	(414 - 162\ga)\eta - (107 - 36\ga)\eta^{2} -  \eta^{3})}{(324 + 72\eta + \eta^{2})^{2}}.
	\end{equation}
	O terceiro termo do numerador da equação acima é o polinômio 
	\[
		p(\eta,\ga) =   324 -	(414 - 162\ga)\eta - (107 - 36\ga)\eta^{2} -  \eta^{3}. 
	\]
	Considerando que  $\sqrt{\ga}<\eta<1$, para $0 < \ga \leq 1/10$, segue que
	\[p(\sqrt{1/10},\ga) >0 \text{ e  } p(1,\ga) <0.\]
	Sob essas condições, como o $p$ é polinômio de grau 3 em $\eta$, pelo Teorema do Valor Intermediário de Bolzano \cite[Teorema 5.3.7]{Bartle:2011tr}, escolhido $\ga$, existe pelo menos uma  raiz  de $p$ no intervalo $(1/10,1)$. 

	Seja $\eta_{1}$ a menor dessas raízes. Nesse caso, por continuidade de $p$, para qualquer $\eta  < \eta_{1}$ e $\ga$ escolhido como acima, temos que  $p(\eta,\ga) >0$.  De fato,  para $0 < \ga \leq 1/10$ e  $\sqrt{\ga}<\eta<1$, temos que  $0<\nextdel<1$  sempre que $\eta < \eta_{1} < 1$, o que completa a demonstração.
% \textcolor{red}{Como terminar? $\nextdel$ precisa ser menor que 1? Maior que 0? O que mais? Já sei que $\eta > \sqrt{\ga}$, para essa escolha de $\mu$ e $\sigma$.}
\end{proof}




% \begin{proof} 
% Por conta dos Lemas \ref{lemma:alC_delta-1} e \ref{lemma:alL_delta-2}, é suficiente considerar o caso em que $\nextal \neq \min\{\nextal_{C},\nextal_{L} \}$.  Considerando as definições dadas na Equação~\eqref{eq:defin-zeta-chi}, podemos rescrever \eqref{eq:theta} como
% \[
% \theta(\al) =  \dfrac{\al\left[ \nu_k\dbvec{\rho_L}_0 + (1-\eta)\dbvec{\rho_C^k } - \al\left(\zeta + \chi
% \right) \right]}{\nu_k\dbvec{\rho_L}_0 +
% \dbvec{\rho_C^k }}.
% \]
	
% 	%FIXME Verificar
% Note que \[\theta'(0) = 1 - \frac{\eta\dbvec{\rho_{C}}}{\nu_k\dbvec{\rho_{L}}_{0}+\dbvec{\rho_{C}}}.\]
% Se 
% \[
% 0< \eta < \dfrac{\nu_k\dbvec{\rho_{L}}_{0}}{\dbvec{\rho_{C}}} + 1 % \leq \frac{\be}{\dbvec{\rho_{C}}_{0}}  + 1,
% \]
% então $\theta'(0)>0$ e por continuidade, temos que é possível escolher $\al_k\in(0,1]$ tal que 
% \[
% 0 < \theta_k = \theta(\al_k) < 1.
% \]

% Portanto, vamos estabelecer um limitante inferior para $\nextal$. Teremos dois casos a considerar. 
% \begin{enumerate}[{Caso} (i):]
% 	\item $(\zeta + \chi) > 0$. Neste caso, $\theta(\al)$ é uma quadrática com concavidade voltada para baixo. Assim, o seu máximo será atingido no vértice, isto é, em
% 	\[
% 		\nextal = \frac{\nu_k\dbvec{\rho_L}_0 + (1-\eta)\dbvec{\rho_C^k }}{2(\zeta + \chi)}.
% 	\]

% 	Note que, neste caso, $\zeta + \chi = \abs{\zeta + \chi} \leq \abs{\zeta} + \abs{\chi}$.  Utilizando as Equações \eqref{eq:bound-zeta} e \eqref{eq:bound-chi}, vemos que  

% 	\[
% 		\nextal \geq \left( \frac{\nu_k\dbvec{\rho_L}_0/\dbvec{\rho_C^k } + (1-\eta)}{2( \omega_1^{2}/n  + \tfrac{1}{2}\omega_{3})}\right)\dfrac{1}{n^{2}}.
% 	\]
% 	\color{red}
% 	Sei que \[ \frac{\norm{\rho_{L}}}{(\xk)^{T}z} = \frac{\dbvec{\rho_{L}}}{\dbvec{\rho_{C}}}=  \frac{\nu_k\dbvec{\rho_L}_0}{\dbvec{\rho_C^k }} \leq \frac{\beta}{\dbvec{\rho_C^k }_0} \] para toda iteração, por conta da vizinhança $\Nset_{\infty}(\ga,\be)$. Como garantir que o limitante de $\nextal$ seja grande o suficiente? Posso considerar que $\rho_{L}\to 0$ antes que $\rho_{C}\to 0$. Nesse caso, posso considerar que se eu escolher $\be\geq 1$ tal que $\frac{\beta}{\dbvec{\rho_C^k }_0} \leq 1$, então temos um limitante suficiente? 


% 	\color{black}
% 	\item $(\zeta + \chi) < 0$. Agora, $\theta(\al)$ é uma quadrática com concavidade voltada para cima. Com isso, o seu máximo será atingido em algum ponto à direita da única raiz não nula, isto é, em $\nextal$, tal que 
% 	\[
% 		\nextal \geq  \frac{\nu_k\dbvec{\rho_L}_0 + (1-\eta)\dbvec{\rho_C^k }}{(\zeta + \chi)}.
% 	\]
% \end{enumerate}
% \end{proof}





Finalmente podemos enunciar e provar o teorema de convergência. 


\begin{teo}[Convergência do Algoritmo \ref{alg:optimized-choice-of-parameters-simplified}]
	\label{teo:alg-convergence-varphi} Seja $0 < \varepsilon <1$ dado. Suponha que a sequência $\{(x^{k},y^{k},z^{k})\}$ gerada pelo Algoritmo~\ref{alg:optimized-choice-of-parameters-simplified} é  tal que 
	para o ponto inicial $(\xzero,\yzero,\zzero)$ seja válido	
	\begin{equation}
	\label{eq:varphi0-eps-kappa}
		\varphi_{0}\leq \dfrac{1}{\varepsilon^{\kappa}}
	\end{equation} 
	com  $\kappa$ uma constante positiva. Então a sequência $\{\varphi_{k}\}$ converge Q-linearmente para zero e existe um índice \[K =  \Oset\left(n^{4}\abs{\ln\frac{1}{\varepsilon}}\right),\] tal que 
	 $\varphi_{k}\leq \varepsilon \text{ para todo } k \geq K$.
	 
\end{teo}

\begin{proof} A convergência Q-linear é consequência direta do Lema \ref{lemma:next-phi-delta-n4}. Quanto à polinomialidade, aplicando o logaritmo em ambos os lados da inequação \eqref{eq:varphi-delta-n4} dada no Lema \ref{lemma:next-phi-delta-n4}, obtemos
	\[
	\ln\varphi_{k+1}\leq \ln \left(1 - \frac{\hat{\delta}}{n^{4}}\right) + \ln\varphi_{k},
	\]
Repetindo tal procedimento na fórmula acima e utilizando \eqref{eq:varphi0-eps-kappa} segue que
\[
	\begin{aligned}
		\ln\varphi_{k} & \leq k \ln\left(1 - \frac{\hat{\delta}}{n^{4}}\right) + \ln \varphi_{0} \\
					& \leq k \ln\left(1 - \frac{\hat{\delta}}{n^{4}}\right) + \kappa\ln \frac{1}{\varepsilon}. 
	\end{aligned}
\] 

Conforme \textcite[Lema 4.1, pg 68]{Wright:Primal-dual-interior-point:1997h}, temos que $\ln(1+r) \leq r$, sempre que $r>-1$. Assim
\[
	\ln\varphi_{k}\leq k \left(- \frac{\hat{\delta}}{n^{4}}\right) + \kappa\ln \frac{1}{\varepsilon}.
\] 

Para que o critério de convergência $\varphi_{k}\leq\varepsilon$ seja satisfeito, devemos garantir que 
\[
	k \left(- \frac{\hat{\delta}}{n^{4}}\right) + \kappa\ln \frac{1}{\varepsilon} \leq \ln\varepsilon.
\] 
De fato, tal inequação é válida para 
\[
	k \geq \dfrac{n^{4}}{\hat{\delta}}(1+\kappa)\ln\frac{1}{\varepsilon},
\]
o que termina a demonstração.
\end{proof}




% \color{red}
O Teorema \ref{teo:alg-convergence-varphi} implica que para um $k$ suficientemente grande, o valor de $\varphi$ será tão pequeno quanto se deseja. No entanto, tal resultado ainda não implica que algum critério de parada usual de Métodos de Pontos Interiores é satisfeito. Porém é possível garantir que o Critério de Parada dado na Equação~\eqref{eq:termination-criteria-pcx}, seja satisfeito para uma escolha particular de $\varepsilon$. Tal garantia é dada pelo Corolário a seguir.

\begin{corol}
Suponha que escolha-se  $\tol = 10^{-8}$  e $\varepsilon$   tal que 
\begin{equation}
	\label{eq:choosing-eps}
		\varepsilon < \min\left\{  \frac{\tol(1+\norm{b})}{m+n}, \frac{\tol(1+\norm{c})}{m+n},\frac{\tol}{n}\right\}.
\end{equation}
Se o Algoritmo \ref{alg:optimized-choice-of-parameters-simplified} converge então o critério de parada dado na Equação~\eqref{eq:termination-criteria-pcx} é satisfeito.
\end{corol}		

\begin{proof}
	 Pelas Definições \ref{def:residual-vector} e \ref{def:merit-function}, vale
	\begin{equation}
		\label{eq:varphi-rhoP-rhoD}
				\varphi_{k} =  \frac{\norm{\rho^{k}_L}_1}{m+n} + 
\frac{(x^{k})^Tz^{k}}{n}  = \frac{\norm{H_{P}(Ax^{k} - b)}_1}{m+n} +\frac{\norm{H_{D}(A^{T}y^{k} + z^{k}- c)}_1 }{m+n} + 
\frac{(x^{k})^Tz^{k}}{n}.
	\end{equation}

Além disso, por equivalência de normas e pela definção de $H_{P}$ e $H_{D}$ dadas na Equação \eqref{eq:defining_matrices_H}, temos que $\norm{Ax^{k} - b} \leq \norm{Ax^{k} - b}_{1} = \norm{H_{P}(Ax^{k} - b)}_{1}$ e que $\norm{H_{D}(A^{T}y^{k} + z^{k}- c)} \leq \norm{A^{T}y^{k} + z^{k}- c}_1 = \norm{H_{D}(A^{T}y^{k} + z^{k}- c)}_1$.

Ademais, se  o Algoritmo \ref{alg:optimized-choice-of-parameters-simplified} converge, existe $k$ suficientemente grande tal que $\varphi_{k}<\eps$. Assim, cada um dos termos da última parte de \eqref{eq:varphi-rhoP-rhoD} é menor que $\varepsilon$.


Daí, pela Equação \eqref{eq:choosing-eps}, segue que 
\[
\dfrac{\norm{Ax^{k} - b}}{1 + \norm{b}} \leq  \frac{\norm{H_{P}(Ax^{k} - b)}_1  }{1 + \norm{b}} < \frac{\eps (m+n)}{1 + \norm{b}} <\frac{\tol(1+\norm{b})}{m+n} \frac{m+n}{1 + \norm{b}} = \tol,
\]
e
\[
\dfrac{\norm{A^{T}y^{k} + z^{k}- c}}{1 + \norm{c}} \leq  \frac{\norm{H_{D}(A^{T}y^{k} + z^{k}- c)}_{1}  }{1 + \norm{c}} < \frac{\eps (m+n)}{1 + \norm{c}} <\frac{\tol(1+\norm{c})}{m+n} \frac{m+n}{1 + \norm{c}} = \tol.
\]
Além disso, como $1+ |c^{T}x^{k}| \geq 1$, temos que 
\[
\dfrac{(x^{k})^{T}z^{k}}{1+ |c^{T}x^{k}|} <   \frac{n\cdot  \eps}{1+ |c^{T}x^{k}|} \leq n \cdot \eps < n \frac{\tol}{n} = \tol. \qedhere
\]
 \end{proof}

  \begin{algorithm}[htb]
 \onehalfspacing
 \caption{Método de Escolha Adiada de Parâmetros Simplificado.}
 \label{alg:optimized-choice-of-parameters-simplified} 
\begin{algorithmic}[1]
\Procedure{ResolveLP}{$A,b,c$}
\State $(\xzero ,\yzero,\zzero ) \gets$ \Call{PontoInicial}{$A,b,c$}.
\Comment{Assegure que  $(\xzero ,\zzero )>0$ e que $\eta\in(0,1)$}
	\For {$k=1,2,\ldots$}
		\State Encontre		$( \dekx,  \deky  ,  \dekz  )$ resolvendo
				\begin{equation}
				\label{eq:predictor-linear-matrix-simplified}
				\bbm A & 0 & 0 \\
				0 & A^T & I\\
				Z^k & 0 & X^k \ebm
				\bbm \dekx  \\ \deky  \\ \dekz
				\ebm = 
				\bbm -r_P^k  \\ -r_D^k \\ -r_C^k
				\ebm.
			\end{equation}
		\State 	Faça $\nextmu=\eta{(x^k)^Tz^k}/{n}$ e  $\nextsig=0$, e resolva 
		% \[((\Decox)^{k},(\Decoy)^{k},(\Decoz)^{k}) = \bar{\mu}((\Dex^{\mu})^{k},(\Dey^{\mu})^{k},(\Dez^{\mu})^{k})\]
		% resolvendo
			\begin{equation}
				\label{eq:corrector-linear-matrix-simplified}
				\bbm A & 0 & 0 \\
				0 & A^T & I\\
				\Zk & 0 & \Xk \ebm
				\bbm (\Decox)^{k} \\ (\Decoy)^{k} \\ (\Decoz)^{k}
				\ebm = 
				\bbm 0  \\ 0 \\  \nextmu e %- \bar{\sig}\deX \dekz 
				\ebm.
			\end{equation}
		\State Encontre $\al^*$ resolvendo o subproblema de
		otimização global 	\eqref{eq:pop-subproblem}.		
		\State Escolha $\al_k = \min\{\al^*,\tilde{\al}_k\}$ com $\tilde{\al}_k$ dado por $\eqref{eq:ratio-test}$ e faça
		\[
		\begin{aligned}	
		& x^{k+1} = x^{k} + \al_k( \dekx + (\Decox)^{k} )
		\\
		& y^{k+1} = y^{k} + \al_k(  \deky   + (\Decoy)^{k} )
		\\
		& z^{k+1} = z^{k} + \al_k(  \dekz   + (\Decoz)^{k} )
		 \end{aligned}. 
		\]		
	\EndFor
\EndProcedure
\end{algorithmic}
\end{algorithm}

No presente capítulo, estabelecemos os resultados de $\eps$-convergência e polinomialidade do nosso método, em relação à função de mérito que estamos usando. Isso foi feito através das ferramentas de demonstração utilizadas em \acl{MPI}, com uma escolha particular do ponto inicial. Além disso, garantimos que é possível escolher um $\eps>0$ tal que um critério de parada equivalente ao usado em várias implementações. Neste sentido, do ponto de vista teórico,  garantimos que o \ac{MPI} de Escolha Adiada de Parâmetros (MPI-EAP) converge assintoticamente para pontos com factibilidade e otimalidade. No capítulo que segue, mostramos alguns experimentos numéricos feitos com este método.



% \color{black}
% \subsection{Um limitante para \texorpdfstring{$\al_k$}{o tamanho do passo} alternativo }

% \color{red} 
% A fim de que o Algoritmo~\ref{alg:optimized-choice-of-parameters-simplified} esteja bem definido, é necessário que exista para cada iteração $k$ uma tripla $(\al_k,\mu_k,\sig_k)$, de modo que seja possível encontrar um próximo ponto $(\nextx,\nexty,\nextz)$. Com efeito, considerando que fixamos os valores de $\mu$ e $\sig$ como $\bar{\mu} $ e  $\bar{\sig}$, basta encontrar um o tamanho de passo ${\al_k}>0$ tal que o próximo ponto $(\nextx,\nexty,\nextz)$ satisfaça as restrições da vizinhança 
% $\Nset_{-\infty}(\gamma,\beta)$ e além disso, garanta que  $0 < \theta(\al_k) <1$. 

% Para tanto, considere-se novamente que vamos fixar $\mu$ e $\sig$ com  as seguintes escolhas $ \mu = \bar{\mu} = \eta\dbvec{\rho_C^k } $ e $\sig = \bar{\sig} \in[\sig_{\min},\sig_{\min}]$ a definir.

%  Primeiramente, utilizando a Equação \eqref{eq:simplified-merit-function-al}, é possível rescrever a função $g_C^i $, para $i=1,\ldots,n$, que foi dada em \eqref{eq:g-Ci_explicit}, somente dependendo de uma escolha de $\al$. De fato, tal função pode ser escrita escrita nos seguintes termos:
% \begin{multline*}
% {g}_C^i (\al)	 = (1-\al)(\rho_C^k )_i+ \al\left(\eta\dbvec{\rho_C^k }\right) +  \al(\al - \barsig) ({L_{0,0}})_i + 
% 				\\ + \al^2\left[  (\eta\dbvec{\rho_C^k })^2(L_{2,0})_i + \eta\dbvec{\rho_C^k } ({L_{1,0}})_i +	\barsig\eta\dbvec{\rho_C^k } ({L_{1,1}})_i		+	    \barsig ({L_{0,1}})_i + \barsig^2(L_{0,2})_i \right]  + \\
% 				 -\ga\left[  (1-\al)\dbvec{\rho_C^k } + \al\left(\eta\dbvec{\rho_C^k } + (\al- \barsig) \dbvec{L_{0,0}} \right) + \al^2\left( \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}} + \barsig\eta\dbvec{\rho_C^k } 
% 				 \dbvec{L_{1,1}}	+	    \barsig \dbvec{L_{0,1}} \right)  \right].
% \end{multline*}

% Definindo as constantes
% \[
% \begin{aligned}
% \zeta_i & = (L_{0,0})_i - \ga \dbvec{L_{0,0}}, \\
% \chi_i  & = \eta\dbvec{\rho_C^k } \left( ({L_{1,0}})_i - \ga\dbvec{L_{1,0}} \right) + \barsig\left( ({L_{0,1}})_i - \ga\dbvec{L_{0,1}} \right),   \\
% \xi_i	& =  (\eta\dbvec{\rho_C^k })^2(L_{2,0})_i + \barsig\eta\dbvec{\rho_C^k } 
% 				 \left(({L_{1,1}})_i - \ga	 \dbvec{L_{1,1}}\right) + \barsig^2(L_{0,2})_i, \\ 	
% \end{aligned}
% \]
%  usando o fato de que o ponto atual pertence à vizinhança $\Nset_{-\infty}(\gamma,\beta)$ e as propriedades de módulo de um escalar, temos
% \[
% \begin{aligned}
% 	g_C^i (\al) & = \underbrace{(1-\al)((\rho_C^k )_i - \ga\dbvec{\rho_C^k })}_{\geq 0}  + (1-\ga)\eta\dbvec{\rho_C^k } \al + \al(\al - \sig) \zeta_i +  (\chi_i + \xi_i)\al^2  \\
% 				& \geq \left( (1-\ga)\eta\dbvec{\rho_C^k }  - \barsig\zeta_i\right)\al + (\zeta_i + 				\chi_i + \xi_i)\al^2 \\ 
% 				& \geq \left( (1-\ga)\eta\dbvec{\rho_C^k }  - {\barsig}{\zeta_i}\right)\al -  (\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i})\al^2 \\
% 				& = \al \left[	(1-\ga)\eta\dbvec{\rho_C^k }  - {\barsig}{\zeta_i}	  -  (\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i})\al	\right] \\
% 				& = h^i(\al).
% \end{aligned}
% \] 

% em que $h^i$ é uma quadrática côncava em função de $\al$ com apenas uma raiz nula. Como queremos que $\al>0$ precisamos que a outra raiz seja positiva. Para tanto, exigimos que 
% \begin{equation}
% 	\label{eq:barsig-bound1}
% 	\barsig\zeta_{i} < (1-\ga)\eta\dbvec{\rho_C^k }.
% \end{equation}


% \begin{itemize}
% 	\item Caso $\eta=0$, como $\barsig>0$, precisamos que $\zeta_{i}<0$, isto é, que  $(L_{0,0})_i - \ga \dbvec{L_{0,0}} < 0$ ou ainda
% \[
% (L_{0,0})_i < \ga \dbvec{L_{0,0}}.
% \]
% \end{itemize}

% Dessa forma,  para  $i=1,\ldots,n$, se $h^i(\al)\geq0$ então $g_C^i(\al)\geq 0$. 

% Com efeito, se \eqref{eq:barsig-bound1} for satisfeito, a única raiz positiva de $h^i$ é dada por
% \[
% \al_{C}^i = \dfrac{(1-\ga)\eta\dbvec{\rho_C^k } - {\barsig}{\zeta_i}}{\abs{\zeta_i} + \abs{\chi_i} + \abs{\xi_i}}
% \]
% e $h^i(\al)\geq 0 $ sempre que $\al\in[0,\al_{C}^i].$ 


% Assim, seja
% \[
% \al_C = \min_i\{\al_C^i\}.
% \] 
% Para $i=1,\ldots,n$, teremos $g_C^i(\al)\geq 0$, quando  
% $\al\in[0,\al_C]$. 



% \[
% \sig<0 \text{ and } \xi>0 \text{ and } \frac{1}{\sig} <\zeta\leq 0 \text{ and } 0<\ga<1-\zeta \sig \text{ and } -\frac{(\zeta \sig)}{(\ga-1)}<\eta\leq 1 \text{ and } \al =\frac{(\zeta \sig+\eta (\ga-1))}{\xi}
% \]




% Por outro lado, us\text{ and }o as mesmas substituições de $\bar{\mu}$ e $\bar{\sig}$, a função $g_L$, dada em \eqref{eq:g-L_explicit} torna-se uma função que depende apenas de $\al$, nos seguintes termos 
% \[
% g_L(\al) =     (1-\al)\left(\dbvec{\rho_C^k } -  \be_L \nu_k   \right) +  \al\eta\dbvec{\rho_C^k } + 
%    \al^2\left( \dbvec{L_{0,0}} + \eta\dbvec{\rho_C^k }  \dbvec{L_{1,0}}   \right ) ,
% 	\]
% Usando novamente o fato de que o ponto atual pertence à  vizinhança $\Nset_{-\infty}(\gamma,\beta)$ e definindo as seguintes constantes 
% \[
% \begin{aligned}
% \zeta & =  \dbvec{L_{0,0}}, \\
% \chi  & = \eta\dbvec{\rho_C^k } \dbvec{L_{1,0}},
% \end{aligned}
% \]
% segue que 
%  \[
% \begin{aligned}
% {g}_L(\al) & =     (1-\al)\underbrace{\left(\dbvec{\rho_C^k } -  \be_L \nu_k   \right)}_{\geq 0} +  \al\eta\dbvec{\rho_C^k } + 
%    \al^2\left( \zeta + \chi   \right ) \\
%    & \geq  \al\left[\eta\dbvec{\rho_C^k } - 
%    \al (\abs{\zeta} + \abs{\chi})   \right ].
% \end{aligned}
%  \]




% Seja $\al_L\in(0,1]$ o maior número tal que  $g_L(\al)\geq 0$, para  $\al\in[0,\al_L]$. Por conta da última inequação acima, temos que se 
% \[
% \al_L \geq \frac{\eta\dbvec{\rho_C^k } }{\abs{\zeta} + \abs{\chi}},
% \]
%  então certamente a condição \eqref{eq:symmetric-polynomials-a} será satisfeita. 






% Por conta do que foi visto até aqui, devemos escolher o tamanho do passo $\al_k$ tal que 
% \begin{equation}
% \label{eq:bound-alpha} 
% 	\al_k \leq \bar{\al} = \arg\max \{\theta(\al):\al\in[0,\min\{\al_C,\al_L\}] \}
% \end{equation}



% \subsection{Um limitante para \texorpdfstring{$\al_k$}{o tamanho do passo} alternativo }

% \color{blue} 
% A fim de que o Algoritmo~\ref{alg:optimized-choice-of-parameters-simplified} esteja bem definido, é necessário que exista para cada iteração $k$ uma tripla $(\al_k,\mu_k,\sig_k)$, de modo que seja possível encontrar um próximo ponto $(\nextx,\nexty,\nextz)$. Com efeito, considerando que fixamos os valores de $\mu$ e $\sig$ como $\bar{\mu} $ e  $\bar{\sig}$, basta encontrar um o tamanho de passo ${\al_k}>0$ tal que o próximo ponto $(\nextx,\nexty,\nextz)$ satisfaça as restrições da vizinhança 
% $\Nset_{-\infty}(\gamma,\beta)$ e além disso, garanta que  $0 < \theta(\al_k) <1$. 

% Para tanto, considere-se novamente que vamos fixar $\mu$ e $\sig$ com  as seguintes escolhas $ \mu = 0$ e $\sig = 1$ a definir.

%  Primeiramente, utilizando a Equação \eqref{eq:simplified-merit-function-al}, é possível rescrever a função $g_C^i $, para $i=1,\ldots,n$, que foi dada em \eqref{eq:g-Ci_explicit}, somente dependendo de uma escolha de $\al$. De fato, tal função pode ser escrita escrita nos seguintes termos:
% \begin{multline*}
% {g}_C^i (\al)	 = (1-\al)(\rho_C^k )_i+   \al(\al - \barsig) ({L_{0,0}})_i  
% 				 + \al^2\left[  ( \barsig ({L_{0,1}})_i + \barsig^2(L_{0,2})_i \right]  + \\
% 				 -\ga\left[  (1-\al)\dbvec{\rho_C^k } +  \al(\al- \barsig) \dbvec{L_{0,0}}  + \al^2\left(   \barsig \dbvec{L_{0,1}} \right)  \right].
% \end{multline*}

% Definindo $\nextsig=1$, e as constantes
% \[
% \begin{aligned}
% \zeta_i & = (L_{0,0})_i - \ga \dbvec{L_{0,0}}, \\
% \chi_i  & =   ({L_{0,1}})_i - \ga\dbvec{L_{0,1}} ,   \\
% \xi_i	& =    (L_{0,2})_i, \\ 	
% \end{aligned}
% \]
%  usando o fato de que o ponto atual pertence à vizinhança $\Nset_{-\infty}(\gamma,\beta)$ e as propriedades de módulo de um escalar, temos
% \[
% \begin{aligned}
% 	g_C^i (\al) & = \underbrace{(1-\al)((\rho_C^k )_i - \ga\dbvec{\rho_C^k })}_{\geq 0}  + \al(\al - 1) \zeta_i +  (\chi_i + \xi_i)\al^2  \\
% 				& \geq  - \zeta_i\al + (\zeta_i + 				\chi_i + \xi_i)\al^2 \\ 
% 				& = h^i(\al).
% \end{aligned}
% \] 
% em que $h^i$ é uma quadrática em função de $\al$ com apenas uma raiz nula dada por  
% \[
% \bar{\al} = \frac{-\zeta_{i}}{\zeta_i + \chi_i + \xi_i}.
% \]


% Se $\zeta_i + \chi_i + \xi_i>0$, então $h^{i}$ tem concavidade voltada para cima e  exigimos que $\bar{\al}<0$. Para isso, precisamos que $\zeta_{i}>0$, isto é $(L_{0,0})_i - \ga \dbvec{L_{0,0}} > 0$ ou ainda
% \[
% (L_{0,0})_i > \ga \dbvec{L_{0,0}}.
% \]


% Caso $\zeta_i + \chi_i + \xi_i<0$, então $h^{i}$ tem concavidade voltada para baixo e  exigimos que $\bar{\al}>0$. Para isso, fazemos  $\zeta_{i}<0$, isto é $(L_{0,0})_i - \ga \dbvec{L_{0,0}} < 0$ ou ainda
% \[
% (L_{0,0})_i < \ga \dbvec{L_{0,0}}.
% \]



% COMO GARANTIR ISSO?

% \color{black}

% \section{Procurar limitantes do que?}

% \textcolor{red}{Esta seção será rescrita. Apenas está aqui para mostrar os  limitantes procurados.}


% Observe que é preciso encontrar limitantes para $ \abs{\zeta}, \abs{\chi}, \abs{\zeta_i}, \abs{\chi_i} \text{ e } \abs{\xi_i}$.
% Com efeito por conta  das definições dessas constantes acima  e do Teorema \ref{thm:next=residual} valem as seguintes observações:
% \begin{enumerate}[(i)]
% 	\item $\abs{\zeta} = \abs{\dbvec{L_{0,0}}} = \abs{\dfrac{( \dekx )^T\dez}{n}} \leq \dfrac{1}{n} \norm{\dex\dez}_1$.
% 	\item Como $\sig=0$, usando a equação \eqref{eq:Corrector-spllited}, temos que 
% 	\[
% 		\Decox = \mu\Dex^\mu \text{ e } \Decoz = \mu\Dez^\mu.
% 	\]
% 	Assim,  
% 	\[
% 	\begin{aligned}
% 	\abs{\chi} & = \abs{\eta\dbvec{\rho_C^k } \dbvec{L_{1,0}}} = \abs{\dfrac{(\dex)^T(\bar{\mu}\Dez^\mu) + (\bar{\mu}\Dex^\mu)^T\dez}{n}   }  \\ 
% 	&  = \abs{\dfrac{(\dex)^T(\Decoz) + (\Decox)^T\dez}{n} }  \\
% 	& \leq \dfrac{1}{n} \norm{\dex\Decoz + \Decox\dez}_1.
% 	\end{aligned}
% 	\]

% \item $\abs{\zeta_i}  = \abs{(L_{0,0})_i - \ga \dbvec{L_{0,0}}} \leq \abs{(L_{0,0})_i} + \ga \abs{\dbvec{L_{0,0}}} \leq
% 					\norm{L_{0,0}}_1  + \dfrac{\ga}{n}\norm{L_{0,0}}_1 \leq 2\norm{L_{0,0}}_1 = 2\norm{\dex\dez}_1.$
% \item Utilizando as ideias de (ii) segue que  
% \[
% \begin{aligned}
% 	\abs{\chi_i }  & = \abs{\eta\dbvec{\rho_C^k } \left( ({L_{1,0}})_i - \ga\dbvec{L_{1,0}} \right)} \\
% 	&  \leq 
% 						\abs{\eta\dbvec{\rho_C^k }  ({L_{1,0}})_i} + \ga\abs { \eta\dbvec{\rho_C^k }\dbvec{L_{1,0}} } \\
% 						& \leq \norm{\dex\Decoz + \Decox\dez}_1 + \dfrac{\ga}{n}\norm{\dex\Decoz + \Decox\dez}_1	\\
% 						& \leq 2 \norm{\dex\Decoz + \Decox\dez}_1
% \end{aligned}
% \]

% \item Novamente, considerando $\sig=0$, usando a equação \eqref{eq:Corrector-spllited},  vale
% \[
% 	(\eta\dbvec{\rho_C^k })^2(L_{2,0}) = (\eta\dbvec{\rho_C^k }\Dex^\mu)(\eta\dbvec{\rho_C^k }\Dez^\mu) = \Decox\Decoz.
% \]
% Assim
% \[
% 	\abs{\xi_i}	 =  \abs{(\eta\dbvec{\rho_C^k })^2(L_{2,0})_i}  = \abs{(\Decox\Decoz)_i} \leq \norm{\Decox\Decoz}_1
% \]

% \end{enumerate}

% Assim precisamos de limitantes para $\norm{\dex\dez}_1$, $\norm{\dex\Decoz + \Decox\dez}_1$ e $\norm{\Decox\Decoz}_1$.


% \chi_i  & = \eta\dbvec{\rho_C^k } \left( ({L_{1,0}})_i - \ga\dbvec{L_{1,0}} \right),   \\
% \xi_i	& =  (\eta\dbvec{\rho_C^k })^2(L_{2,0})_i , \\ 
